1. プロジェクト概要
本プロジェクトは、PCゲーム「Path of Exile」におけるフラスコ、スキル、およびTinctureの継続的な使用を自動化するマクロを開発することを目的とする。プレイヤーの反復的なキー操作を軽減し、より戦略的なプレイに集中できる環境を提供することを目指す。開発にあたっては、ゲームの利用規約に抵触するリスクを考慮し、アンチチートシステム（Warden）に検出されにくいよう、操作タイミングにランダム性を持たせる設計を取り入れる。
2. プロジェクトスコープ
2.1. 開発対象 (スコープ内)
フラスコ自動使用機能: 指定されたキー(1, 2, 4, 5)に割り当てられたフラスコを、それぞれの持続時間に基づいたランダムな遅延間隔でループ使用する機能。Wine of the Prophetを含む。
スキル自動使用機能: 指定されたキー(E, R, T)に割り当てられたスキルを、それぞれ定義されたランダムな間隔でループ使用する機能。
Tincture自動使用機能: 画像認識（テンプレートマッチング）を用いてTinctureの状態（使用可能、アクティブ、クールダウン）を判別し、使用可能になったタイミングで自動的にキー(3)を入力する機能。
検出エリア設定機能（新規追加）: インタラクティブなオーバーレイウィンドウによる検出エリア指定。マウス・キーボード操作による直感的な調整。設定の永続化と解像度別プリセット。フラスコスロットエリア内でのTincture検出。
グラフィカルユーザーインターフェース（GUI）による設定画面:

タブ式の設定ウィンドウによる各種パラメータの視覚的な設定機能
ウィンドウサイズの拡大縮小機能
設定の保存・読み込み機能

ログファイル監視機能: Path of Exileのクライアントログを監視し、エリアの入退場を検出してマクロを自動的にON/OFF制御する機能。
設定ファイル管理機能: YAML形式の設定ファイルによる、各種パラメータの外部管理機能。
マクロ制御機能: マクロ全体の動作を開始・停止するための基本的な制御機能。
プラグイン機構: 新しいフラスコタイプやバフ検出機能を容易に追加できるプラグインアーキテクチャの基盤
2.2. 開発対象外 (スコープ外)

画面上部のバフエリアに表示されるDivination Cardバフアイコンの検出機能（将来の拡張として検討）
Divination Cardバフの優先度に基づくWine of the Prophetの動的制御
フラスコのチャージ量・プログレスバー状態による自動使用制御
ゲーム内状況（プレイヤーの生死など）を判断して動作を自動で変更する高度なロジック
本要件書に記載のないフラスコ、スキル、アイテムの自動化

3. 開発フェーズ (WBS)
フェーズタスク概要1. 環境構築・基盤開発・開発環境セットアップ<br>・画面キャプチャ機能実装<br>・キーボード入力機能実装開発に必要なライブラリ（Python, OpenCV, PyAutoGUI等）を導入する。マルチモニター環境を考慮し、中央のゲーム画面から指定領域をキャプチャする機能や、キーボード入力をエミュレートする基本機能を開発する。2. 機能開発・フラスコループモジュール開発<br>・スキルループモジュール開発<br>・Tinctureループモジュール開発<br>・GUI設定画面の実装<br>・ログファイル監視モジュール開発各機能（フラスコ、スキル、Tincture）を独立したモジュールとして並行開発する。Tinctureモジュールでは、提供された画像を用いたテンプレートマッチングの精度検証と実装を中心に行う。GUIによる設定管理機能を実装する。2.5. 検出エリア設定機能開発・オーバーレイウィンドウ実装<br>・エリア調整UI開発<br>・設定永続化機能<br>・既存検出ロジックの改修半透明オーバーレイによる視覚的な検出エリア設定機能を実装。ユーザーが直接ゲーム画面上でフラスコエリアを指定できるようにする。3. 統合・テスト・モジュール統合<br>・動作テスト<br>・長時間稼働テスト開発した各モジュールを統合し、マクロ全体として意図通りに動作することを確認する。指定されたPC環境（3440x1440 Windowed Fullscreen）で実際にゲームを起動し、テストを実施する。4. ドキュメント作成・操作マニュアル作成マクロの起動・停止方法、GUI操作方法、設定変更方法などを記載したドキュメントを作成する。
4. 使用技術・ツール
開発言語: Python 3.x
主要ライブラリ:

画像認識: OpenCV (opencv-python), NumPy
画面操作: PyAutoGUI, pynput (キーボード・マウス制御)
GUI フレームワーク: Tkinter または PyQt5/PySide2（タブ式インターフェース、リサイズ可能ウィンドウ）
設定管理: PyYAML（設定ファイルの読み込み）
画像処理: PIL/Pillow（画像の前処理）
ファイル監視: watchdog（ログファイルの変更監視）または標準ライブラリのファイル読み込み
ログ解析: 正規表現（re）によるログパターンマッチング
その他: Threading (各機能の並列処理), Random, Time

オーバーレイ実装（追加）:

PyQt5: 半透明ウィンドウ、Always on Top機能
代替案: tkinter + win32gui（Windows専用API）

設定管理拡張（追加）:

detection_areas.yaml: 検出エリア座標の保存

画像認識手法: テンプレートマッチング（OpenCVのmatchTemplate）、閾値による判定
前処理: 必要に応じてグレースケール変換、ノイズ除去
5. リスク管理
リスク項目内容対応策ゲームのアップデートUIのレイアウト変更やアイコンデザインの変更により、画像認識が機能しなくなる可能性がある。テンプレート画像を容易に差し替えられるような構造で設計する。定期的なメンテナンスが必要になることを明記する。環境依存性ディスプレイ解像度やゲーム内UIスケールの違いにより、画像認識の座標がずれる可能性がある。初期設定として、ユーザーがTinctureの位置座標を指定する方式を検討する。アカウント利用停止マクロの使用はPath of Exileの利用規約に違反し、アカウントが停止されるリスクが常にある。これは自己責任であることを明確に伝える。検出リスクを低減するため、全ての遅延や間隔にランダム性を導入するが、リスクを完全に排除するものではないことを強調する。ログファイルアクセスゲームクライアントがログファイルをロックしている場合の読み込みエラー読み取り専用モードでのアクセス、エラー時のリトライ機構ログフォーマット変更ゲームアップデートによるログ形式の変更ログパターンを設定ファイルで管理し、容易に更新可能な構造オーバーレイ互換性（追加）フルスクリーンゲームでオーバーレイが表示されない可能性Windowed Fullscreenモードでの使用を推奨。複数の実装方式を検討座標系の違い（追加）マルチモニター環境での座標計算の複雑性モニター相対座標とグローバル座標の変換処理を実装